"use strict";(self.webpackChunkdetoxweb=self.webpackChunkdetoxweb||[]).push([[890],{1933:(t,s,e)=>{e.d(s,{R:()=>a});var i=e(5684);class a{constructor(t){this.Da=t}Cb(){(0,i.i)(this.da)&&this.Pe()}sa(){(0,i.c)(this.da)&&window.cancelAnimationFrame(this.da),this.da=void 0}Pe(){this.da=window.requestAnimationFrame((()=>{(0,i.i)(this.da)||(this.Da(),this.Pe())}))}}},7509:(t,s,e)=>{e.r(s),e.d(s,{GoogleCastProvider:()=>d});var i=e(5684),a=e(7707),n=e(1933),h=e(9569);e(5043);class r{constructor(t){this.El=new chrome.cast.media.MediaInfo(t.src,t.type)}build(){return this.El}dm(t){return t.includes("live")?this.El.streamType=chrome.cast.media.StreamType.LIVE:this.El.streamType=chrome.cast.media.StreamType.BUFFERED,this}em(t){return this.El.tracks=t.map(this.fm),this}gm(t,s){return this.El.metadata=new chrome.cast.media.GenericMediaMetadata,this.El.metadata.title=t,this.El.metadata.images=[{url:s}],this}fm(t,s){const e=new chrome.cast.media.Track(s,chrome.cast.media.TrackType.TEXT);return e.name=t.label,e.trackContentId=t.src,e.trackContentType="text/vtt",e.language=t.language,e.subtype=t.kind.toUpperCase(),e}}const l=chrome.cast.media.TrackType.TEXT,o=chrome.cast.media.TrackType.AUDIO;class c{constructor(t,s,e){this.Il=t,this.b=s,this.Ll=e}mk(){const t=this.Ql.bind(this);(0,i.l)(this.b.audioTracks,"change",t),(0,i.l)(this.b.textTracks,"mode-change",t),(0,i.g)(this.hm.bind(this))}Hl(){return this.b.$state.textTracks().filter((t=>t.src&&"vtt"===t.type))}Rl(){return this.b.$state.audioTracks()}Gl(t){var s,e;const i=null!==(s=null===(e=this.Il.mediaInfo)||void 0===e?void 0:e.tracks)&&void 0!==s?s:[];return t?i.filter((s=>s.type===t)):i}im(){const t=[],s=this.Rl().find((t=>t.selected)),e=this.Hl().filter((t=>"showing"===t.mode));if(s){const e=this.Gl(o),i=this.Kl(e,s);i&&t.push(i.trackId)}if(null!==e&&void 0!==e&&e.length){const s=this.Gl(l);if(s.length)for(const i of e){const e=this.Kl(s,i);e&&t.push(e.trackId)}}return t}hm(){const t=this.Hl();if(!this.Il.isMediaLoaded)return;const s=this.Gl(l);for(const e of t){if(!this.Kl(s,e)){(0,i.z)((()=>{var t;return null===(t=this.Ll)||void 0===t?void 0:t.call(this)}));break}}}jm(t){if(!this.Il.isMediaLoaded)return;const s=this.Rl(),e=this.Hl(),i=this.Gl(o),n=this.Gl(l);for(const r of i){var h;if(this.Sl(s,r))continue;const e={id:r.trackId.toString(),label:r.name,language:r.language,kind:null!==(h=r.subtype)&&void 0!==h?h:"main",selected:!1};this.b.audioTracks[a.L.pa](e,t)}for(const a of n){if(this.Sl(e,a))continue;const s={id:a.trackId.toString(),src:a.trackContentId,label:a.name,language:a.language,kind:a.subtype.toLowerCase()};this.b.textTracks.add(s,t)}}Ql(t){if(!this.Il.isMediaLoaded)return;const s=this.im(),e=new chrome.cast.media.EditTracksInfoRequest(s);this.km(e).catch((t=>{}))}km(t){const s=(0,h.g)();return new Promise(((e,i)=>null===s||void 0===s?void 0:s.editTracksInfo(t,e,i)))}Sl(t,s){return t.find((t=>this.Tl(t,s)))}Kl(t,s){return t.find((t=>this.Tl(s,t)))}Tl(t,s){return s.name===t.label&&s.language===t.language&&s.subtype.toLowerCase()===t.kind.toLowerCase()}}class d{constructor(t,s){this.ba=t,this.b=s,this.$$PROVIDER_TYPE="GOOGLE_CAST",this.scope=(0,i.h)(),this.W=null,this.nc="disconnected",this.Wa=0,this.Ga=0,this.Ha=new a.T(0,0),this.Ib=new a.T(0,0),this.Ea=new n.R(this.cd.bind(this)),this.Cl=null,this.Ml=!1,this.zb=new c(this.ba,this.b,this.Ll.bind(this))}get c(){return this.b.delegate.c}get type(){return"google-cast"}get currentSrc(){return this.W}get player(){return this.ba}get cast(){return(0,h.a)()}get session(){return(0,h.b)()}get media(){return(0,h.g)()}get hasActiveSession(){return(0,h.h)(this.W)}setup(){this.lm(),this.mm(),this.zb.mk(),this.c("provider-setup",this)}lm(){(0,h.l)(cast.framework.CastContextEventType.CAST_STATE_CHANGED,this.Vl.bind(this))}mm(){const t=cast.framework.RemotePlayerEventType,s={[t.IS_CONNECTED_CHANGED]:this.Vl,[t.IS_MEDIA_LOADED_CHANGED]:this.Wl,[t.CAN_CONTROL_VOLUME_CHANGED]:this.Xl,[t.CAN_SEEK_CHANGED]:this.Yl,[t.DURATION_CHANGED]:this.xg,[t.IS_MUTED_CHANGED]:this.bb,[t.VOLUME_LEVEL_CHANGED]:this.bb,[t.IS_PAUSED_CHANGED]:this.nm,[t.LIVE_SEEKABLE_RANGE_CHANGED]:this.jc,[t.PLAYER_STATE_CHANGED]:this.om};this.Ul=s;const e=this.pm.bind(this);for(const a of(0,i.A)(s))this.ba.controller.addEventListener(a,e);(0,i.w)((()=>{for(const t of(0,i.A)(s))this.ba.controller.removeEventListener(t,e)}))}async play(){var t;(this.ba.isPaused||this.Ml)&&(this.Ml?await this.Zl(!1,0):null===(t=this.ba.controller)||void 0===t||t.playOrPause())}async pause(){var t;this.ba.isPaused||null===(t=this.ba.controller)||void 0===t||t.playOrPause()}getMediaStatus(t){return new Promise(((s,e)=>{var i;null===(i=this.media)||void 0===i||i.getStatus(t,s,e)}))}setMuted(t){var s;(t&&!this.ba.isMuted||!t&&this.ba.isMuted)&&(null===(s=this.ba.controller)||void 0===s||s.muteOrUnmute())}setCurrentTime(t){var s;this.ba.currentTime=t,this.c("seeking",t),null===(s=this.ba.controller)||void 0===s||s.seek()}setVolume(t){var s;this.ba.volumeLevel=t,null===(s=this.ba.controller)||void 0===s||s.setVolumeLevel()}async loadSource(t){var s;if((null===(s=this.Cl)||void 0===s?void 0:s.src)!==t&&(this.Cl=null),(0,h.h)(t))return this.qm(),void(this.W=t);this.c("load-start");const e=this.rm(t),i=await this.session.loadMedia(e);if(i)return this.W=null,void this.c("error",Error((0,h.c)(i)));this.W=t}destroy(){this.I(),this._l()}I(){this.Cl||(this.Ga=0,this.Ha=new a.T(0,0),this.Ib=new a.T(0,0)),this.Ea.sa(),this.Wa=0,this.Cl=null}qm(){var t,s,e;const a=new i.D("resume-session",{detail:this.session});this.Wl(a);const{muted:n,volume:h,remotePlaybackInfo:r}=this.b.$state,l=r();this.setCurrentTime(Math.max(this.ba.currentTime,null!==(t=null===l||void 0===l||null===(s=l.savedState)||void 0===s?void 0:s.currentTime)&&void 0!==t?t:0)),this.setMuted(n()),this.setVolume(h()),!1===(null===l||void 0===l||null===(e=l.savedState)||void 0===e?void 0:e.paused)&&this.play()}_l(){this.cast.endCurrentSession(!0);const{remotePlaybackLoader:t}=this.b.$state;t.set(null)}sm(){this.b.$state.remotePlaybackInfo.set({savedState:{paused:this.ba.isPaused,currentTime:this.ba.currentTime}}),this._l()}cd(){this.tm()}pm(t){this.Ul[t.type].call(this,t)}Vl(t){const s=this.cast.getCastState(),e=s===cast.framework.CastState.CONNECTED?"connected":s===cast.framework.CastState.CONNECTING?"connecting":"disconnected";if(this.nc===e)return;const i={type:"google-cast",state:e},a=this.Fl(t);this.nc=e,this.c("remote-playback-change",i,a),"disconnected"===e&&this.sm()}Wl(t){if(!!!this.ba.isMediaLoaded)return;const s=(0,i.p)(this.b.$state.source);Promise.resolve().then((()=>{if(s!==(0,i.p)(this.b.$state.source)||!this.ba.isMediaLoaded)return;this.I();const e=this.ba.duration;this.Ib=new a.T(0,e);const n={provider:this,duration:e,buffered:this.Ha,seekable:this.$l()},h=this.Fl(t);this.c("loaded-metadata",void 0,h),this.c("loaded-data",void 0,h),this.c("can-play",n,h),this.Xl(),this.Yl(t);const{volume:r,muted:l}=this.b.$state;this.setVolume(r()),this.setMuted(l()),this.Ea.Cb(),this.zb.jm(h),this.zb.Ql(h)}))}Xl(){this.b.$state.canSetVolume.set(this.ba.canControlVolume)}Yl(t){const s=this.Fl(t);this.c("stream-type-change",this.um(),s)}um(){var t;return(null===(t=this.ba.mediaInfo)||void 0===t?void 0:t.streamType)===chrome.cast.media.StreamType.LIVE?this.ba.canSeek?"live:dvr":"live":"on-demand"}tm(){if(this.Cl)return;const t=this.ba.currentTime;if(t===this.Wa)return;const s=this.Ga,e={currentTime:t,played:this.Ek(t)};this.c("time-update",e),t>s&&this.jc(),this.b.$state.seeking()&&this.c("seeked",t),this.Wa=t}Ek(t){return this.Ga>=t?this.Ha:this.Ha=new a.T(0,this.Ga=t)}xg(t){if(!this.ba.isMediaLoaded||this.Cl)return;const s=this.ba.duration,e=this.Fl(t);this.Ib=new a.T(0,s),this.c("duration-change",s,e)}bb(t){if(!this.ba.isMediaLoaded)return;const s={muted:this.ba.isMuted,volume:this.ba.volumeLevel},e=this.Fl(t);this.c("volume-change",s,e)}nm(t){const s=this.Fl(t);this.ba.isPaused?this.c("pause",void 0,s):this.c("play",void 0,s)}jc(t){const s={seekable:this.$l(),buffered:this.Ha},e=t?this.Fl(t):void 0;this.c("progress",s,e)}om(t){const s=this.ba.playerState,e=chrome.cast.media.PlayerState;if(this.Ml=s===e.IDLE,s===e.PAUSED)return;const i=this.Fl(t);switch(s){case e.PLAYING:this.c("playing",void 0,i);break;case e.BUFFERING:this.c("waiting",void 0,i);break;case e.IDLE:this.Ea.sa(),this.c("pause"),this.c("end")}}$l(){return this.ba.liveSeekableRange?new a.T(this.ba.liveSeekableRange.start,this.ba.liveSeekableRange.end):this.Ib}Fl(t){return t instanceof Event?t:new i.D(t.type,{detail:t})}vm(t){const{streamType:s,title:e,poster:i}=this.b.$state;return new r(t).gm(e(),i()).dm(s()).em(this.zb.Hl()).build()}rm(t){var s,e,i,a,n,h,r;const l=this.vm(t),o=new chrome.cast.media.LoadRequest(l),c=this.b.$state.remotePlaybackInfo();return o.autoplay=!1===(null!==(s=null===(e=this.Cl)||void 0===e?void 0:e.paused)&&void 0!==s?s:null===c||void 0===c||null===(i=c.savedState)||void 0===i?void 0:i.paused),o.currentTime=null!==(a=null!==(n=null===(h=this.Cl)||void 0===h?void 0:h.time)&&void 0!==n?n:null===c||void 0===c||null===(r=c.savedState)||void 0===r?void 0:r.currentTime)&&void 0!==a?a:0,o}async Zl(t,s){const e=(0,i.p)(this.b.$state.source);this.Cl={src:e,paused:t,time:s},await this.loadSource(e)}Ll(){this.Zl(this.ba.isPaused,this.ba.currentTime).catch((t=>{}))}}}}]);
//# sourceMappingURL=890.fc9f6fbf.chunk.js.map